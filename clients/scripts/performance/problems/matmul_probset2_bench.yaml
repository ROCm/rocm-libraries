---
include: ../../../include/hipblaslt_common.yaml
include: ../../../gtest/matmul_common.yaml

Definitions:
  # - &transA_transB_range
  #   - { transA: N, transB: N }
  #   - { transA: N, transB: T }
  #   - { transA: T, transB: N }
  #   - { transA: T, transB: T }

BF16 In Out: &bf16_precision_dst_bf16
  - { a_type: bf16_r, b_type: bf16_r, c_type: bf16_r, d_type: bf16_r, compute_type: c_f32_r, scale_type: f32_r}

Tests:
- name: matmul_bf16_bf16
  function:
    matmul: *bf16_precision_dst_bf16
  matrix_size:
    - { M:   896,    N:    16,    K:  5120  }
    - { M:   896,    N:    64,    K:  5120  }
    - { M:   896,    N:   128,    K:  5120  }
    - { M:   896,    N:   256,    K:  5120  }
    - { M:   896,    N:   512,    K:  5120  }
    - { M:   896,    N:  1024,    K:  5120  }
    - { M:   896,    N:  2048,    K:  5120  }
    - { M:   896,    N:  4096,    K:  5120  }
    - { M:  1024,    N:    16,    K:  5120  }
    - { M:  1024,    N:    64,    K:  5120  }
    - { M:  1024,    N:   128,    K:  5120  }
    - { M:  1024,    N:   256,    K:  5120  }
    - { M:  1024,    N:   512,    K:  5120  }
    - { M:  1024,    N:  1024,    K:  5120  }
    - { M:  1024,    N:  2048,    K:  5120  }
    - { M:  1024,    N:  4096,    K:  5120  }
    - { M:  2048,    N:    16,    K:  5120  }
    - { M:  2048,    N:    64,    K:  5120  }
    - { M:  2048,    N:   128,    K:  5120  }
    - { M:  2048,    N:   256,    K:  5120  }
    - { M:  2048,    N:   512,    K:  5120  }
    - { M:  2048,    N:  1024,    K:  5120  }
    - { M:  2048,    N:  2048,    K:  5120  }
    - { M:  2048,    N:  4096,    K:  5120  }
    - { M:  4096,    N:    16,    K:  5120  }
    - { M:  4096,    N:    64,    K:  5120  }
    - { M:  4096,    N:   128,    K:  5120  }
    - { M:  4096,    N:   256,    K:  5120  }
    - { M:  4096,    N:   512,    K:  5120  }
    - { M:  4096,    N:  1024,    K:  5120  }
    - { M:  4096,    N:  2048,    K:  5120  }
    - { M:  4096,    N:  4096,    K:  5120  }
    - { M: 16384,    N:    16,    K:  5120  }
    - { M: 16384,    N:    64,    K:  5120  }
    - { M: 16384,    N:   128,    K:  5120  }
    - { M: 16384,    N:   256,    K:  5120  }
    - { M: 16384,    N:   512,    K:  5120  }
    - { M: 16384,    N:  1024,    K:  5120  }
    - { M: 16384,    N:  2048,    K:  5120  }
    - { M: 16384,    N:  4096,    K:  5120  }
    - { M:  5120,    N:    16,    K:   640  }
    - { M:  5120,    N:    64,    K:   640  }
    - { M:  5120,    N:   128,    K:   640  }
    - { M:  5120,    N:   256,    K:   640  }
    - { M:  5120,    N:   512,    K:   640  }
    - { M:  5120,    N:  1024,    K:   640  }
    - { M:  5120,    N:  2048,    K:   640  }
    - { M:  5120,    N:  4096,    K:   640  }
    - { M:  5120,    N:    16,    K:  1024  }
    - { M:  5120,    N:    64,    K:  1024  }
    - { M:  5120,    N:   128,    K:  1024  }
    - { M:  5120,    N:   256,    K:  1024  }
    - { M:  5120,    N:   512,    K:  1024  }
    - { M:  5120,    N:  1024,    K:  1024  }
    - { M:  5120,    N:  2048,    K:  1024  }
    - { M:  5120,    N:  4096,    K:  1024  }
    - { M:  5120,    N:    16,    K:  2048  }
    - { M:  5120,    N:    64,    K:  2048  }
    - { M:  5120,    N:   128,    K:  2048  }
    - { M:  5120,    N:   256,    K:  2048  }
    - { M:  5120,    N:   512,    K:  2048  }
    - { M:  5120,    N:  1024,    K:  2048  }
    - { M:  5120,    N:  2048,    K:  2048  }
    - { M:  5120,    N:  4096,    K:  2048  }
    - { M:  5120,    N:    16,    K:  8192  }
    - { M:  5120,    N:    64,    K:  8192  }
    - { M:  5120,    N:   128,    K:  8192  }
    - { M:  5120,    N:   256,    K:  8192  }
    - { M:  5120,    N:   512,    K:  8192  }
    - { M:  5120,    N:  1024,    K:  8192  }
    - { M:  5120,    N:  2048,    K:  8192  }
    - { M:  5120,    N:  4096,    K:  8192  }
  initialization: trig_float
  transA: T
  transB: N
  iters: 1000
  cold_iters: 1000
  algo_method: 0
  api_method: 2
  rotating: 512
  gpu_arch: '94?'

- name: matmul_fp8n_bf16
  function:
    matmul: *f8_fnuz_precision_dst_bf16
  matrix_size:
    - { M:   896,    N:    16,    K:  5120  }
    - { M:   896,    N:    64,    K:  5120  }
    - { M:   896,    N:   128,    K:  5120  }
    - { M:   896,    N:   256,    K:  5120  }
    - { M:   896,    N:   512,    K:  5120  }
    - { M:   896,    N:  1024,    K:  5120  }
    - { M:   896,    N:  2048,    K:  5120  }
    - { M:   896,    N:  4096,    K:  5120  }
    - { M:  1024,    N:    16,    K:  5120  }
    - { M:  1024,    N:    64,    K:  5120  }
    - { M:  1024,    N:   128,    K:  5120  }
    - { M:  1024,    N:   256,    K:  5120  }
    - { M:  1024,    N:   512,    K:  5120  }
    - { M:  1024,    N:  1024,    K:  5120  }
    - { M:  1024,    N:  2048,    K:  5120  }
    - { M:  1024,    N:  4096,    K:  5120  }
    - { M:  2048,    N:    16,    K:  5120  }
    - { M:  2048,    N:    64,    K:  5120  }
    - { M:  2048,    N:   128,    K:  5120  }
    - { M:  2048,    N:   256,    K:  5120  }
    - { M:  2048,    N:   512,    K:  5120  }
    - { M:  2048,    N:  1024,    K:  5120  }
    - { M:  2048,    N:  2048,    K:  5120  }
    - { M:  2048,    N:  4096,    K:  5120  }
    - { M:  4096,    N:    16,    K:  5120  }
    - { M:  4096,    N:    64,    K:  5120  }
    - { M:  4096,    N:   128,    K:  5120  }
    - { M:  4096,    N:   256,    K:  5120  }
    - { M:  4096,    N:   512,    K:  5120  }
    - { M:  4096,    N:  1024,    K:  5120  }
    - { M:  4096,    N:  2048,    K:  5120  }
    - { M:  4096,    N:  4096,    K:  5120  }
    - { M: 16384,    N:    16,    K:  5120  }
    - { M: 16384,    N:    64,    K:  5120  }
    - { M: 16384,    N:   128,    K:  5120  }
    - { M: 16384,    N:   256,    K:  5120  }
    - { M: 16384,    N:   512,    K:  5120  }
    - { M: 16384,    N:  1024,    K:  5120  }
    - { M: 16384,    N:  2048,    K:  5120  }
    - { M: 16384,    N:  4096,    K:  5120  }
    - { M:  5120,    N:    16,    K:   640  }
    - { M:  5120,    N:    64,    K:   640  }
    - { M:  5120,    N:   128,    K:   640  }
    - { M:  5120,    N:   256,    K:   640  }
    - { M:  5120,    N:   512,    K:   640  }
    - { M:  5120,    N:  1024,    K:   640  }
    - { M:  5120,    N:  2048,    K:   640  }
    - { M:  5120,    N:  4096,    K:   640  }
    - { M:  5120,    N:    16,    K:  1024  }
    - { M:  5120,    N:    64,    K:  1024  }
    - { M:  5120,    N:   128,    K:  1024  }
    - { M:  5120,    N:   256,    K:  1024  }
    - { M:  5120,    N:   512,    K:  1024  }
    - { M:  5120,    N:  1024,    K:  1024  }
    - { M:  5120,    N:  2048,    K:  1024  }
    - { M:  5120,    N:  4096,    K:  1024  }
    - { M:  5120,    N:    16,    K:  2048  }
    - { M:  5120,    N:    64,    K:  2048  }
    - { M:  5120,    N:   128,    K:  2048  }
    - { M:  5120,    N:   256,    K:  2048  }
    - { M:  5120,    N:   512,    K:  2048  }
    - { M:  5120,    N:  1024,    K:  2048  }
    - { M:  5120,    N:  2048,    K:  2048  }
    - { M:  5120,    N:  4096,    K:  2048  }
    - { M:  5120,    N:    16,    K:  8192  }
    - { M:  5120,    N:    64,    K:  8192  }
    - { M:  5120,    N:   128,    K:  8192  }
    - { M:  5120,    N:   256,    K:  8192  }
    - { M:  5120,    N:   512,    K:  8192  }
    - { M:  5120,    N:  1024,    K:  8192  }
    - { M:  5120,    N:  2048,    K:  8192  }
    - { M:  5120,    N:  4096,    K:  8192  }
  initialization: trig_float
  transA: T
  transB: N
  scaleA: 2
  scaleB: 2
  iters: 1000
  cold_iters: 1000
  algo_method: 0
  api_method: 2
  rotating: 512
  gpu_arch: '94?'
...